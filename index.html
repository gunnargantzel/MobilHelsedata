<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobil Helsedata</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Samle og del helsedata og lokasjonsdata">
    <meta name="theme-color" content="#2563eb">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Mobil Helsedata">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json?v=7">
    
    <!-- Favicon -->
    <link rel="icon" href="icons/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%232563eb' rx='20'/><text x='50' y='65' font-family='Arial' font-size='60' text-anchor='middle' fill='white'>游낀</text></svg>" type="image/svg+xml">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="version-badge">v1.1.5</div>
            <h1>游낀 Mobil Helsedata</h1>
            <p>Samle og del din helsedata p친 en sikker m친te</p>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Login Section -->
            <section class="login-section" id="login-section">
                <div class="login-card">
                    <h2>游댏 Logg inn med Entra ID</h2>
                    <p>Du m친 v칝re logget inn for 친 samle og dele helsedata. Vi bruker Microsoft Entra ID for sikker autentisering.</p>
                    <button class="btn-primary" id="login-btn">Logg inn med Microsoft</button>
                </div>
            </section>

            <!-- User Section -->
            <section class="user-section" id="user-section" style="display: none;">
                <div class="user-card">
                    <div class="user-info">
                        <h3>游녻 Logget inn som</h3>
                        <p id="user-name">Bruker</p>
                        <p id="user-email" class="user-email"></p>
                    </div>
                    <button class="btn-secondary" id="logout-btn">Logg ut</button>
                </div>
            </section>

            <!-- Welcome Section -->
            <section class="welcome-section">
                <div class="welcome-card">
                    <h2>Velkommen til Mobil Helsedata</h2>
                    <p>Denne appen lar deg samle og dele helsedata og lokasjonsdata p친 en sikker m친te. Du har full kontroll over hvilke data som deles.</p>
                </div>
            </section>

            <!-- Permissions Section -->
            <section class="permissions-section">
                <div class="permission-card">
                    <div class="permission-header">
                        <h3>游늸 Lokasjonsdata</h3>
                        <div class="permission-status" id="location-status">
                            <span class="status-indicator pending"></span>
                            <span class="status-text">Ikke gitt</span>
                        </div>
                    </div>
                    <p>Tillat appen 친 f친 tilgang til din lokasjon for 친 samle lokasjonsdata.</p>
                    <button class="permission-btn" id="location-btn" disabled>
                        Be om tillatelse
                    </button>
                </div>

                <div class="permission-card">
                    <div class="permission-header">
                        <h3>仇벒잺 Apple Health Data</h3>
                        <div class="permission-status" id="health-status">
                            <span class="status-indicator pending"></span>
                            <span class="status-text">Ikke gitt</span>
                        </div>
                    </div>
                    <p>Velg hvilke helsedata fra Apple Health du vil dele.</p>
                    <button class="permission-btn" id="health-btn" disabled>
                        Velg helsedata
                    </button>
                </div>
            </section>

            <!-- Data Selection Modal -->
            <div class="modal" id="health-modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Velg helsedata 친 dele</h3>
                        <button class="close-btn" id="close-modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="data-categories">
                            <div class="category">
                                <h4>Hjerte og sirkulasjon</h4>
                                <div class="data-options">
                                    <label class="data-option">
                                        <input type="checkbox" value="heartRate">
                                        <span>Hjerteslag</span>
                                    </label>
                                    <label class="data-option">
                                        <input type="checkbox" value="bloodPressure">
                                        <span>Blodtrykk</span>
                                    </label>
                                    <label class="data-option">
                                        <input type="checkbox" value="restingHeartRate">
                                        <span>Hvilende hjerteslag</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="category">
                                <h4>Aktivitet</h4>
                                <div class="data-options">
                                    <label class="data-option">
                                        <input type="checkbox" value="steps">
                                        <span>Skritt</span>
                                    </label>
                                    <label class="data-option">
                                        <input type="checkbox" value="distance">
                                        <span>Distanse</span>
                                    </label>
                                    <label class="data-option">
                                        <input type="checkbox" value="activeEnergy">
                                        <span>Aktiv energi</span>
                                    </label>
                                    <label class="data-option">
                                        <input type="checkbox" value="exerciseTime">
                                        <span>Trenings tid</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="category">
                                <h4>S칮vn</h4>
                                <div class="data-options">
                                    <label class="data-option">
                                        <input type="checkbox" value="sleepAnalysis">
                                        <span>S칮vnanalyse</span>
                                    </label>
                                    <label class="data-option">
                                        <input type="checkbox" value="bedtime">
                                        <span>Leggetid</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="category">
                                <h4>Kroppsm친l</h4>
                                <div class="data-options">
                                    <label class="data-option">
                                        <input type="checkbox" value="weight">
                                        <span>Vekt</span>
                                    </label>
                                    <label class="data-option">
                                        <input type="checkbox" value="height">
                                        <span>H칮yde</span>
                                    </label>
                                    <label class="data-option">
                                        <input type="checkbox" value="bmi">
                                        <span>BMI</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" id="cancel-health">Avbryt</button>
                        <button class="btn-primary" id="confirm-health">Bekreft valg</button>
                    </div>
                </div>
            </div>

            <!-- Data Summary -->
            <section class="data-summary" id="data-summary" style="display: none;">
                <h3>Samlet data</h3>
                <div class="summary-cards">
                    <div class="summary-card">
                        <h4>Lokasjon</h4>
                        <p id="location-summary">Ingen data</p>
                    </div>
                    <div class="summary-card">
                        <h4>Helsedata</h4>
                        <p id="health-summary">Ingen data valgt</p>
                    </div>
                </div>
                <button class="btn-primary" id="share-data">Del data</button>
            </section>
        </main>

    </div>

    <!-- Scripts -->
    <script src="dataverse-config.js?v=1"></script>
    <script type="module">
      import { PublicClientApplication } from 'https://cdn.skypack.dev/@azure/msal-browser@4.22.1';
      window.PublicClientApplication = PublicClientApplication;
    </script>
    <script src="azure-app.js?v=16"></script>
</body>
</html>
